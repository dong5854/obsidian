# 계기

1. 웹으로 가볍게 원카드를 하고 싶은데 마음에 드는 사이트가 없음
2. 평소에서 카드게임을 좋아해서 한번 만들어 보고 싶었음
# 배포 환경
## 후보

1. AWS 같은 클라우드 서비스
	- 편리하지만 비용이 발생함, 프리티어는 성능과 1년 제한이 아쉬움
2. vercel + firebase
	- 다른 개인프로젝트에서 사용하고 있음
		- firebase 문서에 따르면 Firebase Realtime Database를 사용하면 게임 앱을 충분히 만들수 있다고 하지만, 백엔드가 firsbase 에 종속되는 부분이 마음에 들지 않음
3. 개인 서버 구축
	- 위의 2 방식보다 서버 구축에 공수가 많이 들어감
	- 전기세 + 서버 장비를 구입하는데 비용 발생

## 우선순위

1. 현재 토이프로젝트 개발이 최우선 순위가 아니기 때문에 개발 기간이 길 예정
	- 사용시간에 따라 결제되는 방식은 효율적이지 못할 것 같음
2. 원하는 기술 스택을 사용하고 싶음
	 - 재밌게 만들고 평소 사용하고 싶던 기술, 프레임워크를 사용해보고 싶기 때문에 원하는 자유도가 높아야 함
## 결정

1. 개발 기간이 길어질수록 클라우드 서비스 자원을 사용하며 낭비되는 비용이 클 것 같아 aws 의 클라우드 서비스의 사용은 탈락
2. aws lambda 혹은 firebase 는 벤더에 종속이 되어 자유도가 떨어지고 원하는 기술을 자유롭게 사용해보기 어려울 것 같아 탈락

결국 소거법으로 [[개인 서버 구축하기]]로 마음을 먹음

# 백엔드

언어 : Java or Kotlin
백엔드 : spring mvc or spring webflux

언어 선택 : Kotlin 을 사용하고 싶었지만 Java 로 개발을 하고 kotlin 으로 전환하는 것도 재미있을 것 같아 처음에는 Java 로 개발하기로 결정

백엔드 : 게임 서비스이므로 spring webflux 가 더 적절하고 생각되지만 좀 더 일반적인 기술인 mvc 로 먼저 개발을 해보기로 결정
추후 webflux 로 바꾸는 것 고려, webflux는 특히 Non-Blocking db 인 Redis 를 사용할 예정이라 궁합이 좋을 것 같음

실시간 통신 
- 데이터 저장: 웹소켓을 통해 Redis Stack 에 JSON 형태로 저장한 정보를 클라이언트에 뿌려주는 식으로 결정

- 메시지 브로커: Redis pub/sub, Redis stream, Kafka, RabbitMQ 를 다양하기 고민중이나 일단 처음에 구현은 Spring 에 내장된 Simple Message Broker 를 사용하고 좀 더 고민한 후 바꿀 예정, 인메모리 기반 브로커는 서버가 내려가거나 다수의 서버가 공유하지 못해 바꾸기는 할 예정

데이터베이스 : 현재 구상중인 모습에서는 영구저장을 위한 데이터베이스가 필요하지 않으나 필요해진다면 MySQL 을 사용할 예정

결론 : Java + spring mvc 로 개발하고 kotlin + spring webflux 로 전환을 해볼 예정, 비효율적이나 토이 프로젝트이기에 해볼 수 있는 결정이라고 생각, 인메모리 DB로는 Redis 사용하고 메시지 브로커는 미정
- [[Redis Stack 그리고 Redis OM]]
- [[spring mvc 와 spring webflux 차이]]
- [[메시지 브로커 선택, Redis stream, Redis pubsub, Kafka, Rabbit MQ]]

# 프론트엔드

- 프론트엔드는 큰 고민없이 Next.js 를 사용해 vercel 로 배포할 예정

# 인프라

사내 교육에서 쿠버네티스를 접해볼 기회가 있었는데, 쿠버네티스를 사용하며 argocd 와 Istio 사용 예정
- [[argoCD와 Jenkins 차이]]
- [[ISTIO 란?]]

# 기타
- [[trivy 적용해보기]]